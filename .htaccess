# SECURITY HEADERS
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set X-Content-Type-Options "nosniff"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

# Prevent directory listing
Options -Indexes

# Block access to .env, .git, config, and other sensitive files
<FilesMatch "\.(env|git|htaccess|htpasswd|ini|phps|fla|psd|log|sh|bak)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Remove .php extension from URL
RewriteEngine On

# Redirect direct .php requests to extensionless URLs
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteRule ^ %1 [R=301,L]

# Internally rewrite extensionless URLs to .php (handles subdirectories)
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+?)/?$ $1.php [L]

# Optional: Force HTTPS (uncomment if you have SSL)
# RewriteCond %{HTTPS} off
# RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Block access to hidden files and directories (starting with .)
RewriteRule "(^|/)\." - [F]